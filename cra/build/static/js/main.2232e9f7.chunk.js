(this.webpackJsonpmaze=this.webpackJsonpmaze||[]).push([[0],{40:function(t,e,i){},41:function(t,e,i){},45:function(t,e,i){"use strict";i.r(e);var n,s=i(2),r=i.n(s),o=i(30),a=i.n(o),c=(i(40),i(13)),l=(i(41),i(48)),h=i(31),u=i(17),d=i(18),g=[{index:0,name:"up",getIndices:function(t,e){return[t-1,e]}},{index:1,name:"right",getIndices:function(t,e){return[t,e+1]}},{index:2,name:"down",getIndices:function(t,e){return[t+1,e]}},{index:3,name:"left",getIndices:function(t,e){return[t,e-1]}}],v=function(){function t(e){var i=e.canvasCtx,n=e.index,s=e.rowIndex,r=e.colIndex,o=e.size,a=void 0===o?25:o,c=e.borderWeight,l=void 0===c?2:c,h=e.borderColor,d=void 0===h?"gray":h,g=e.cursorColor,v=void 0===g?"yellow":g,b=e.visitedColor,f=void 0===b?"rgba(0, 0, 0, 0.1)":b,x=e.backtrackColor,C=void 0===x?"white":x,p=e.renderInitial,w=void 0!==p&&p,j=e.isStart,k=void 0!==j&&j,y=e.isMiddle,S=void 0!==y&&y,I=e.isEnd,O=void 0!==I&&I;Object(u.a)(this,t),this.canvasCtx=void 0,this.index=void 0,this.rowIndex=void 0,this.colIndex=void 0,this.x=void 0,this.y=void 0,this.size=void 0,this.borderColor=void 0,this.borderWeight=void 0,this.cursorColor=void 0,this.visitedColor=void 0,this.backtrackColor=void 0,this.renderInitial=void 0,this.isStart=void 0,this.isMiddle=void 0,this.isEnd=void 0,this.connections=void 0,this.walls=void 0,this.visited=void 0,this.pathId=void 0,this.cursor=void 0,this.backtrack=void 0,this.blockedInternal=void 0,this.blockedExternal=void 0,this.canvasCtx=i,this.index=n,this.rowIndex=s,this.colIndex=r,this.x=this.colIndex*a+l,this.y=this.rowIndex*a+l,this.size=a,this.borderColor=d,this.borderWeight=l,this.cursorColor=v,this.visitedColor=f,this.backtrackColor=C,this.isStart=k,this.isMiddle=S,this.isEnd=O,this.connections=[],this.walls=w?[!0,!0,!0,!0]:[!1,!1,!1,!1],this.visited=!1}return Object(d.a)(t,[{key:"getIndex",value:function(){return this.index}},{key:"getConnections",value:function(){return this.connections}},{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{mutual:!0},i=e.mutual;return this.connections.push(t),t.rowIndex>this.rowIndex&&(this.walls[2]=!1),t.rowIndex<this.rowIndex&&(this.walls[0]=!1),t.colIndex>this.colIndex&&(this.walls[1]=!1),t.colIndex<this.colIndex&&(this.walls[3]=!1),i&&t.connect(this,{mutual:!1}),this}},{key:"disconnect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{mutual:!0},i=e.mutual;return this.connections=this.connections.filter((function(e){return e.index===t.index})),i&&t.disconnect(this,{mutual:!1}),this}},{key:"isVisited",value:function(){return this.visited}},{key:"setAsBacktrack",value:function(){this.backtrack=!0}},{key:"setAsVisited",value:function(){this.visited=!0}},{key:"visit",value:function(t,e){return this.pathId=e,this.visited=!0,this.cursor=!0,this.isStart||this.isEnd||(this.walls=[!0,!0,!0,!0]),t&&this.connect(t),this}},{key:"hasDifferentPathId",value:function(t){return this.pathId&&t.pathId&&this.pathId!==t.pathId}},{key:"getFillColor",value:function(){switch(!0){case this.blockedExternal:case this.blockedInternal:return this.borderColor;case this.cursor:return this.cursorColor;case this.backtrack:return this.backtrackColor;case this.visited:return this.visitedColor;default:return"white"}}},{key:"draw",value:function(){this.drawFill(this.getFillColor()),this.drawWalls(this.walls),this.cursor=!1}},{key:"drawFill",value:function(t){var e=this.x+.5*this.borderWeight,i=this.y+.5*this.borderWeight;this.canvasCtx.fillStyle=t,this.canvasCtx.fillRect(e,i,this.size,this.size)}},{key:"drawWalls",value:function(t){var e=this.canvasCtx;e.strokeStyle=this.borderColor,e.lineWidth=this.borderWeight,this.walls[0]&&this.line(this.x,this.y,this.x+this.size,this.y),this.walls[1]&&(this.isEnd||this.line(this.x+this.size,this.y,this.x+this.size,this.y+this.size)),this.walls[2]&&this.line(this.x,this.y+this.size,this.x+this.size,this.y+this.size),this.walls[3]&&(this.isStart||this.line(this.x,this.y,this.x,this.y+this.size))}},{key:"line",value:function(t,e,i,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",r=this.canvasCtx;r.strokeStyle=s,r.beginPath(),r.moveTo(t,e),r.lineTo(i,n),r.stroke()}}]),t}(),b=function(){function t(e){var i=e.rows,n=e.cols,s=e.borderWeight,r=void 0===s?1:s,o=e.startIndex,a=void 0===o?0:o,c=e.cellSize,l=void 0===c?10:c,h=e.canvasCtx;Object(u.a)(this,t),this.rows=void 0,this.cols=void 0,this.cellTotal=void 0,this.cellSize=void 0,this.borderWeight=void 0,this.startIndex=void 0,this.endIndex=void 0,this.cells=void 0,this.canvasCtx=void 0,this.rows=i,this.cols=n,this.cellTotal=i*n,this.cellSize=l,this.borderWeight=r,this.startIndex=a,this.endIndex=this.cellTotal-1,this.cells=[],this.canvasCtx=h,this.create()}return Object(d.a)(t,[{key:"create",value:function(){for(var t=Math.floor(this.rows/2),e=t*this.cols+t,i=0;i<this.cellTotal;i++){var n=new v({canvasCtx:this.canvasCtx,index:i,colIndex:i%this.cols,rowIndex:Math.floor(i/this.cols),size:this.cellSize,borderWeight:this.borderWeight,visitedColor:"rgb(208, 222, 247)",backtrackColor:"#fff",isStart:i===this.startIndex,isMiddle:i===e,isEnd:i===this.endIndex,renderInitial:!0});this.cells.push(n)}}},{key:"getCells",value:function(){return this.cells}},{key:"getRows",value:function(){return this.rows}},{key:"getColumns",value:function(){return this.cols}},{key:"getStartCell",value:function(){var t=this.getCellByIndex();return t.setAsVisited(),t}},{key:"getCellByIndex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.cells[t]}},{key:"getNeighbors",value:function(t){var e=this;return g.map((function(i){var n=i.getIndices(t.rowIndex,t.colIndex),s=Object(c.a)(n,2),r=s[0],o=s[1];return r<0||o<0||r>e.rows-1||o>e.cols-1?null:r*e.cols+o})).filter((function(t){return null!==t})).map((function(t){return e.cells[t]}))}},{key:"getUnvisitedNeighbors",value:function(t){return this.getNeighbors(t).filter((function(t){return!t.isVisited()}))}},{key:"pickNeighbor",value:function(t){var e=this.getUnvisitedNeighbors(t);return e[Math.floor(Math.random()*e.length)]}},{key:"draw",value:function(){var t,e=this.getCells(),i=Object(h.a)(e);try{for(i.s();!(t=i.n()).done;){t.value.draw()}}catch(n){i.e(n)}finally{i.f()}}}]),t}(),f=i(19),x=i(20),C=x.a.canvas(n||(n=Object(f.a)(["\n  margin: 100px;\n"]))),p=i(9),w=i(49),j=i(5),k=function(t){var e,i=t.grid,n=t.pathId,s=t.current,r=t.startIndex,o=void 0===r?0:r,a=t.endIndex,c=void 0===a?null:a;if(s){if(e=i.pickNeighbor(s))return e.visit(s,n)}else null!==c?(e=i.getCells()[c]).isEnd=!0:(e=i.getCells()[o]).isStart=!0,e.visit(null,n);return e},y=Object(w.a)({id:"maze-generation",strict:!1,initial:"idle",context:{settings:{gridColumns:0,gridRows:0,startIndex:0,pathId:"abc",fps:3},grid:void 0,currentCell:void 0,unvisitedNeighbors:[],stack:[]},on:{INJECT_REFS:{target:"start"}},states:{idle:{},start:{entry:[function(){console.log("------------ START -------------")},"initGeneration","pushToStack"],after:{SEEK_INTERVAL:{target:"seek"}}},seek:{entry:["findNeighbors"],always:[{target:"advance"}]},advance:{always:[{target:"backtrack",cond:"isDeadEnd"}],entry:["pickNextCell","pushToStack"],after:{SEEK_INTERVAL:{target:"seek"}}},backtrack:{entry:["popFromStack"],always:[{target:"complete",cond:"isBackAtStart"},{target:"seek"}]},complete:{on:{RESTART:"start"}}}},{guards:{isDeadEnd:function(t){return 0===t.unvisitedNeighbors.length},isBackAtStart:function(t){return 0===t.stack.length}},actions:{initGeneration:Object(j.b)((function(t,e){var i=t.settings,n=e.gridRef,s=e.fps,r=Object(p.a)(Object(p.a)({},i),{},{gridColumns:n.current.cols,gridRows:n.current.rows,fps:s}),o=n.current.getStartCell();return{settings:r,grid:n.current,currentCell:o,stack:[]}})),findNeighbors:Object(j.b)((function(t){var e=t.grid,i=t.currentCell;return{unvisitedNeighbors:e.getUnvisitedNeighbors(i)}})),pickNextCell:Object(j.b)((function(t){var e=t.settings,i=t.grid,n=t.currentCell;return{currentCell:k({grid:i,pathId:e.pathId,current:n,startIndex:0})}})),pushToStack:Object(j.b)((function(t){var e=t.stack,i=t.currentCell;return i&&e.push(i),{stack:e}})),popFromStack:Object(j.b)((function(t){var e=t.stack,i=e.pop();return null===i||void 0===i||i.setAsBacktrack(),{stack:e,currentCell:i}}))},delays:{SEEK_INTERVAL:function(t){return 1e3/t.settings.fps}}}),S=i(8),I=function(t){var e=t.playRequestTS,i=t.width,n=void 0===i?100:i,s=t.height,o=void 0===s?100:s,a=t.pixelRatio,h=void 0===a?window.devicePixelRatio:a,u=t.fps,d=t.cellSize,g=t.borderWeight,v=t.gridColumns,f=t.gridRows,x=r.a.useRef(null),p=r.a.useRef(new b({cols:v,rows:f})),w=Object(l.a)(y),j=Object(c.a)(w,2),k=(j[0],j[1]),I=v*f,O=I-1;r.a.useEffect((function(){if(x&&x.current&&p.current){var t=x.current.getContext("2d");t.clearRect(0,0,n,o),p.current=new b({cols:v,rows:f,canvasCtx:t,cellSize:d,borderWeight:g}),k("INJECT_REFS",{gridRef:p,fps:u})}}),[e,u,d,g,I,v,f,O,o,h,n,k]),p.current&&p.current.canvasCtx&&p.current.draw();var m=Math.floor(h*n),R=Math.floor(h*o);return Object(S.jsx)(C,{ref:x,width:m,height:R})},O=r.a.memo(I,(function(t,e){return e.settingsChanging}));var m,R=i(10),E={createPlayRequest:Object(R.createAction)("CREATE_PLAY_REQUEST")(),setFPS:Object(R.createAction)("SET_FPS")(),setCellSize:Object(R.createAction)("SET_SELL_SIZE")(),setBorderWeight:Object(R.createAction)("SET_BORDER_WEIGHT")(),setGridColumns:Object(R.createAction)("SET_GRID_COLUMNS")(),setGridRows:Object(R.createAction)("SET_GRID_ROWS")(),setSettingsChanging:Object(R.createAction)("SET_SETTINGS_CHANGING")()},T=function(t,e){var i=e.type,n=e.payload;switch(i){case Object(R.getType)(E.createPlayRequest):return Object(p.a)(Object(p.a)({},t),{},{playRequestTS:n});case Object(R.getType)(E.setFPS):return Object(p.a)(Object(p.a)({},t),{},{fps:n});case Object(R.getType)(E.setCellSize):return Object(p.a)(Object(p.a)({},t),{},{cellSize:n});case Object(R.getType)(E.setBorderWeight):return Object(p.a)(Object(p.a)({},t),{},{borderWeight:n});case Object(R.getType)(E.setGridColumns):return Object(p.a)(Object(p.a)({},t),{},{gridColumns:n});case Object(R.getType)(E.setGridRows):return Object(p.a)(Object(p.a)({},t),{},{gridRows:n});case Object(R.getType)(E.setSettingsChanging):return Object(p.a)(Object(p.a)({},t),{},{settingsChanging:n});default:return t}},z=x.a.form(m||(m=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),W=window.innerWidth,N=window.innerHeight,A=5,M=100,_={playRequestTS:0,fps:24,cellSize:20,borderWeight:1,gridColumns:40,gridRows:20,settingsChanging:!1},G=function(){var t=function(t,e,i){var n=Object(s.useReducer)(t,e),r=Object(c.a)(n,2),o=r[0],a=r[1];return[o,Object(s.useMemo)((function(){return Object.keys(i).reduce((function(t,e){var n,s;return t[e]=(n=i[e],s=a,function(){return s(n.apply(this,arguments))}),t}),{})}),[a,i])]}(T,_,E),e=Object(c.a)(t,2),i=e[0],n=e[1];return Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)(O,{playRequestTS:i.playRequestTS,width:W,height:N,fps:i.fps,cellSize:i.cellSize,borderWeight:i.borderWeight,gridColumns:i.gridColumns,gridRows:i.gridRows,pixelRatio:1,settingsChanging:Boolean(i.settingsChanging)}),Object(S.jsxs)(z,{children:[Object(S.jsxs)("label",{children:["FPS (",i.fps,")",Object(S.jsx)("input",{type:"range",name:"fps",value:i.fps,min:"5",max:"60",step:5,onMouseDown:function(){return n.setSettingsChanging(!0)},onMouseUp:function(){return n.setSettingsChanging(!1)},onChange:function(t){var e=t.target.value;n.setFPS(parseInt(e,10))}})]}),Object(S.jsxs)("label",{children:["Cell Size (",i.cellSize,")",Object(S.jsx)("input",{type:"range",name:"cellSize",value:i.cellSize,min:A,max:M,step:5,onMouseDown:function(){return n.setSettingsChanging(!0)},onMouseUp:function(){return n.setSettingsChanging(!1)},onChange:function(t){var e=t.target.value;return n.setCellSize(parseInt(e,10))}})]}),Object(S.jsxs)("label",{children:["Border Weight (",i.borderWeight,")",Object(S.jsx)("input",{type:"range",name:"borderWeight",value:i.borderWeight,min:"1",max:.5*i.cellSize,onMouseDown:function(){return n.setSettingsChanging(!0)},onMouseUp:function(){return n.setSettingsChanging(!1)},onChange:function(t){var e=t.target.value;return n.setBorderWeight(parseInt(e,10))}})]}),Object(S.jsxs)("label",{children:["Grid Columns (",i.gridColumns,")",Object(S.jsx)("input",{type:"range",name:"gridColumns",value:i.gridColumns,min:"2",max:"50",onMouseDown:function(){return n.setSettingsChanging(!0)},onMouseUp:function(){return n.setSettingsChanging(!1)},onChange:function(t){var e=t.target.value;return n.setGridColumns(parseInt(e,10))}})]}),Object(S.jsxs)("label",{children:["Grid Rows (",i.gridRows,")",Object(S.jsx)("input",{type:"range",name:"gridRows",value:i.gridRows,min:"2",max:"50",onMouseDown:function(){return n.setSettingsChanging(!0)},onMouseUp:function(){return n.setSettingsChanging(!1)},onChange:function(t){var e=t.target.value;return n.setGridRows(parseInt(e,10))}})]}),Object(S.jsx)("button",{onClick:function(t){t.preventDefault(),n.createPlayRequest((new Date).getTime())},children:"Replay"})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(Object(S.jsx)(G,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[45,1,2]]]);
//# sourceMappingURL=main.2232e9f7.chunk.js.map